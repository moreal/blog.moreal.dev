<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    Fedify CLI로 Content Warnings 이해하기 — 삽질하는 블로그
  </title>
  <link rel="stylesheet" href="/static/style.css">
  <link rel="shortcut icon" href="/static/logo.svg" type="image/svg+xml">
  <meta name="description" content="블로그 포스트">
  <meta name="author" content="Moreal (Lee Dogeon)" />
  <meta name="fediverse:creator" content="moreal@hackers.pub" />
  <link rel="me" href="https://social.silicon.moe/@moreal" />
  <link rel="me" href="https://hackers.pub/@moreal" />
</head>

<body class="post">
  
  <header class="post-header">
    <time datetime="2025-03-29T15:00:00.000Z" class="publish-date">
      2025년 3월 29일
    </time>
  </header>
  

  <main>
    <article>
      <h1>Fedify CLI로 Content Warnings 이해하기</h1>
<h2>서문 (동기)</h2>
<p>Mastodon에서 글을 쓸 때 Content Warnings을 자주 쓰는데:</p>
<ol>
<li>내가 쓰는 글이 어떤 사람에게는 기분 상할 글일 수도 있을까 하는 걱정도 있고,</li>
<li>혼자 말을 자주 적는데 소음같이 느껴져서 보고 싶지 않을 사람도 있을까 싶어서
&quot;혼자 말&quot; 같은 경고문을 달고 적어놓는다.</li>
</ol>
<p>요즘은 &quot;혼자 말&quot; 대신 요약을 좀 적어놓는 편인 것 같다. 그런데 Mastodon에서 글을
적으면 몇 글자 더 적을 수 있는지, 글자 수 제한을 표시해준다. Content Warnings을
적는데도 글자 수 제한이 줄어드는 것을 보고 본문과 Content Warnings가 같은 필드에
있는 걸까 그런 궁금증이 들었다. 어떻게 생겼는지 보고 글을 적고 있는 지금 다시
생각하면, 조금 잘못된(?) 상상이었던 것 같지만 암튼 그랬다.</p>
<h2>본문</h2>
<h3>Activity 객체 읽어오기</h3>
<p>내가 적은 글의 Activity 객체 버전을 확인해보려면 어떻게 해야 하지 싶던 중,
@hongminhee@hackers.pub 님이 만드신 <a href="https://fedify.dev">Fedify</a>에서 제공하는 CLI 도구에 관련 기능이
있었던 것 같아 살펴보니 <a href="https://fedify.dev/cli#fedify-lookup-looking-up-an-activitypub-object"><code>fedify lookup</code></a>이라는 명령어가
있었다.</p>
<p>사용법은 아래와 같이 인자로 글 URL을 넘겨주면 됐다.</p>
<pre><code>fedify lookup https://social.silicon.moe/@moreal/114252336335817713
</code></pre>
<p>그러면 아래와 같이 Activity 객체 내용을 보여준다:</p>
<pre><code>$ fedify lookup https://social.silicon.moe/@moreal/114252336335817713
✔ Fetched object: https://social.silicon.moe/@moreal/114252336335817713.
Note {
  id: URL &quot;https://social.silicon.moe/users/moreal/statuses/114252336335817713&quot;,
  attribution: URL &quot;https://social.silicon.moe/users/moreal&quot;,
  contents: [ &quot;&lt;p&gt;본문&lt;/p&gt;&quot;, &lt;ko&gt; &quot;&lt;p&gt;본문&lt;/p&gt;&quot; ],
  published: 2025-03-30T16:31:40Z,
  replies: Collection {
    id: URL &quot;https://social.silicon.moe/users/moreal/statuses/114252336335817713/replies&quot;,
    first: CollectionPage {
      partOf: URL &quot;https://social.silicon.moe/users/moreal/statuses/114252336335817713/replies&quot;,
      next: URL &quot;https://social.silicon.moe/users/moreal/statuses/114252336335817713/replies?only_other_accounts=true&amp;page=true&quot;
    }
  },
  shares: Collection {
    id: URL &quot;https://social.silicon.moe/users/moreal/statuses/114252336335817713/shares&quot;,
    totalItems: 0
  },
  likes: Collection {
    id: URL &quot;https://social.silicon.moe/users/moreal/statuses/114252336335817713/likes&quot;,
    totalItems: 0
  },
  summary: &quot;Content Warning 테스트&quot;,
  url: URL &quot;https://social.silicon.moe/@moreal/114252336335817713&quot;,
  to: URL &quot;https://social.silicon.moe/users/moreal/followers&quot;,
  cc: URL &quot;https://www.w3.org/ns/activitystreams#Public&quot;,
  sensitive: true
}
✔ Successfully fetched the object.
</code></pre>
<h3>Activity 객체 이해하기</h3>
<p>&quot;Content Warnings&quot;에 넣었던 <code>Content Warning 테스트</code>라는 문구는 <code>summary</code> 필드에
들어있었다.</p>
<p><code>summary</code> 필드에 대해 살펴보기 위해서 <a href="https://www.w3.org/TR/activitypub/">ActivityPub 문서</a>에 들어갔다.
<code>&quot;Note&quot;</code>를 키워드로 검색해보니 아래 같은 예제를 발견했다:</p>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;type&quot;: &quot;Note&quot;,
  &quot;to&quot;: [&quot;https://chatty.example/ben/&quot;],
  &quot;attributedTo&quot;: &quot;https://social.example/alyssa/&quot;,
  &quot;content&quot;: &quot;Say, did you finish reading that book I lent you?&quot;
}
</code></pre>
<p>예전에 Fedify에 기여할 때 기억으로는 Activity가 <a href="https://json-ld.org/">JSON-LD</a>
포맷으로 표현되므로 스키마를 확인하고자 <code>@context</code> 필드의 링크로 들어갔다.
그렇게 타고 들어가서
<a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-note">Note의 정의</a>를
발견했는데
<a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-object">Object</a>를
상속하였고, 상속받은 것 외에 자신만의 필드는 없어 보였다.</p>
<p>링크를 또 타고 들어가
<a href="https://www.w3.org/TR/activitystreams-vocabulary/#dfn-summary">summary의 정의</a>를
볼 수 있었다. 설명은 아래와 같다:</p>
<pre><code>A natural language summarization of the object encoded as HTML. Multiple language tagged summaries MAY be provided.
</code></pre>
<p>HTML로 스타일링할 수도 있고, 여러 언어별로 요약을 제공할 수도 있다고 한다. 아래
JSON은 문서에 있는 예제인데, 영어(en)와 스페인어(es), 중국어 간체(zh-Hans)
언어마다 요약을 각각 제공하는 것으로 보인다.</p>
<pre><code class="language-json">{
  &quot;@context&quot;: &quot;https://www.w3.org/ns/activitystreams&quot;,
  &quot;name&quot;: &quot;Cane Sugar Processing&quot;,
  &quot;type&quot;: &quot;Note&quot;,
  &quot;summaryMap&quot;: {
    &quot;en&quot;: &quot;A simple &lt;em&gt;note&lt;/em&gt;&quot;,
    &quot;es&quot;: &quot;Una &lt;em&gt;nota&lt;/em&gt; sencilla&quot;,
    &quot;zh-Hans&quot;: &quot;一段&lt;em&gt;简单的&lt;/em&gt;笔记&quot;
  }
}
</code></pre>
<h2>결론</h2>
<ul>
<li><s><code>Content Warnings</code>에 요약을 적는 건 적절한 용례이다! (?)</s>
<ul>
<li>+) Hackers' Pub에서
<a href="https://hackers.pub/@hongminhee/0195e9b8-8824-7461-85e8-346664f4fa2a">댓글</a>로
달아주셔서 알게된 놓친 부분인데, <code>Content Warnings</code>를 쓰면
<a href="https://docs.joinmastodon.org/spec/activitypub/#sensitive"><code>as:sensitive</code></a>
확장 속성도 같이 추가되어서 Mastodon에서 <code>Content Warnings</code>를 요약으로 쓰는
것이 마냥 맞는 용례는 아닌 것 같다.</li>
</ul>
</li>
<li>사용자가 주로 사용하는 언어로 작성하면, 애플리케이션 단에서 다른 요약들도
번역해서 자동으로 채워줄 수도 있겠다. (읽는 쪽에서 번역하는 게 나으려나)</li>
</ul>

    </article>
  </main>
</body>

</html>